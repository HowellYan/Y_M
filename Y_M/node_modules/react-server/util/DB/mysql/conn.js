'use strict';

/**
 * mysql 连接操作
 */

const mysql = require('mysql');
const getconfig = require('../../getString/getconfig');

let connection = null;
class Connection  {
	constructor(args) {
		if(connection == null ){
			let variable = new getconfig().getVariable();
			let mysqlMsg = null;
			if(variable == "dev"){
				mysqlMsg = new getconfig().getDev();
			} else if(variable == "pro"){
				mysqlMsg = new getconfig().getPro();
			}
			try {
				connection = mysql.createConnection({
				  host     : mysqlMsg['mysql']['host'],
				  user     : mysqlMsg['mysql']['user'],
				  password : mysqlMsg['mysql']['password'],
				  database : mysqlMsg['mysql']['database']
				});
			} catch (err) {
				console.log('err: ', err);
			}
		}
			try {
				connection.query('select * from db_user', function(err, rows, fields) {
				  if (err) throw err;
				  console.log('The solution is: ', rows[0]);
				});
			} catch (err) {
				console.log('err: ', err);
			}
	}

}

module.exports = Connection;